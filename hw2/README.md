# PIXEL SCI-FI 🎮

一個使用 React + TypeScript + Vite 開發的生存輪次射擊遊戲。

P.S. 打開瀏覽器試玩的時候，盡量開啟全螢幕模式（右上角的三個點點按下去，在縮放那排點選全螢幕）

## 🎮 遊玩方法

### 基本操作

- **移動**：方向鍵 或 WASD
- **自動攻擊**：武器會自動瞄準最近的敵人
- **商店**：每波結束後自動進入商店

### 遊戲目標

1. **生存**：避免被敵人碰到
2. **擊敗敵人**：使用武器擊敗所有敵人
3. **升級**：獲得經驗值升級角色
4. **購買升級**：在商店購買武器和屬性升級
5. **挑戰更高輪次**：挑戰越來越強的敵人輪次

## 🚀 如何安裝

### 環境需求

- Node.js 16.0 或更高版本
- npm 或 yarn 套件管理器

### 安裝步驟

1. **複製專案**

```bash
git clone <repository-url>
cd hw2
```

2. **安裝所需套件**

```bash
npm install
```

3. **啟動伺服器**

```bash
npm run dev
```

4. **開啟瀏覽器**
   訪問 `http://localhost:5173/` 開始遊戲

### 建置生產版本

```bash
npm run build
```

## 📦 套件

### 執行

- `react`: ^18.3.1 - React 框架
- `react-dom`: ^18.3.1 - React DOM 渲染

### 開發

- `vite`: ^5.4.8 - 建置工具
- `@vitejs/plugin-react`: ^4.3.1 - React 插件
- `typescript`: ^5.6.2 - TypeScript 編譯器
- `@types/react`: ^18.3.11 - React 型別定義
- `@types/react-dom`: ^18.3.1 - React DOM 型別定義
- `@types/node`: ^22.18.6 - Node.js 型別定義

## 🎯 遊戲特色

- **自動射擊系統**：玩家只需移動，武器會自動瞄準最近的敵人
- **多種武器選擇**：三種不同特性的武器
- **敵人波次系統**：隨著輪次增加，敵人會變得更強
- **升級系統**：擊敗敵人獲得經驗值升級，提升能力
- **商店系統**：每波結束後可購買武器升級
- **豐富音效**：包含背景音樂和音效

## 📁 專案架構

```
hw2/
├─ index.html                # 入口 HTML
├─ package.json              # 腳本與依賴
├─ tsconfig.json             # TypeScript 設定（前端）
├─ tsconfig.node.json        # TypeScript 設定（Node/Vite）
├─ vite.config.ts            # Vite 設定（含路徑別名）
├─ src/
│  ├─ main.tsx              # React 入口，掛載 App
│  ├─ App.tsx               # App 骨架：選單 / 畫布 / HUD / 商店
│  ├─ styles.css            # 遊戲樣式
│  ├─ components/
│  │  ├─ GameCanvas.tsx     # <canvas> 渲染與 rAF 迴圈、鍵盤輸入
│  │  ├─ HUD.tsx            # 頂部 HUD（HP / 金錢 / 輪次 / 階段）
│  │  ├─ ShopModal.tsx      # 商店（購買升級）
│  │  ├─ Screens.tsx        # 開始畫面
│  │  └─ WeaponSelect.tsx   # 武器選擇畫面
│  ├─ game/
│  │  ├─ GameContext.tsx    # 世界狀態與核心更新（useRef 儲存）
│  │  ├─ config/
│  │  │  └─ GameConfig.ts    # 遊戲配置（敵人、武器、玩家參數）
│  │  ├─ types.ts           # 型別定義（World / Player / Enemy / Projectile / Wave / UI）
│  │  ├─ utils.ts           # 工具函數（距離、單位向量、邊緣生成）
│  │  └─ audio.ts           # 音效管理系統
│  ├─ hooks/
│  │  └─ useRaf.ts          # 可重用 rAF Hook
│  └─ asset/                 # 遊戲資源
│     ├─ audio/             # 音效檔案
│     ├─ main_character/    # 主角動畫
│     ├─ enemy/            # 敵人動畫
│     └─ weapon/           # 武器圖片
```

## 🎮 遊戲設計

### 核心機制

- **狀態管理**：使用 `useRef` 儲存遊戲世界狀態，避免每幀觸發 React re-render
- **遊戲迴圈**：以 `<canvas>` + `requestAnimationFrame` 每幀更新
- **自動攻擊**：固定間隔找出射程內最近敵人，產生子彈（含速度向量）
- **敵人 AI**：從地圖邊緣 or 隨機出生，持續朝玩家移動
- **輪次系統**：清空當前波次敵人 → 進入商店 → 發放金錢 → 可購買升級 → 進入下一波

### 遊戲階段

1. **開始畫面**：遊戲介紹和操作說明
2. **武器選擇**：選擇初始武器
3. **遊戲進行**：30 秒的時間，請盡力不要讓血量歸0
4. **商店階段**：購買升級和武器
5. **勝利/失敗**：遊戲結束畫面

## 🔊 音效系統

### 背景音樂

- **大廳背景音樂**：在開始畫面和武器選擇時播放
- **遊戲背景音樂**：戰鬥時播放

### 音效效果

- **UI 音效**：按鈕點擊、準備音效
- **武器音效**：不同武器有不同射擊音效
- **敵人音效**：衝刺音效
- **遊戲音效**：升級、購買、勝利、失敗音效
- **水中效果**：在特定 UI 狀態下背景音樂會有水中濾波效果

## 👤 主角配置

### 基本屬性

- **生命值**：100 HP（可透過升級增加）
- **移動速度**：4 單位/幀
- **碰撞半徑**：15 像素
- **經驗值系統**：擊敗敵人獲得經驗值升級

### 動畫系統

- **待機動畫**：400ms 切換一幀
- **移動動畫**：120ms 切換一幀
- **死亡動畫**：180ms 切換一幀
- **勝利動畫**：140ms 切換一幀

### 升級系統

- **攻擊傷害**：+50% 傷害
- **攻擊速度**：+30% 攻速

## 👹 敵人配置

### 敵人類型

#### 1. mask_dude

- **生命值**：15 HP（每波 +5）
- **移動速度**：2.8（每波 +0.1）
- **傷害**：5
- **獎勵金錢**：5
- **解鎖波次**：第 1 波
- **生成間隔**：1.3 秒
- **場上上限**：10 隻

#### 2. ninja_frog

- **生命值**：25 HP（每波 +8）
- **移動速度**：2.0（每波 +0.15）
- **傷害**：10
- **獎勵金錢**：15
- **解鎖波次**：第 2 波
- **生成間隔**：2.8 秒
- **場上上限**：8 隻

#### 3. pink_man

- **生命值**：70 HP（每波 +12）
- **移動速度**：1.0（每波 +0.05）
- **傷害**：20
- **獎勵金錢**：20
- **解鎖波次**：第 3 波
- **生成間隔**：4.0 秒
- **場上上限**：3 隻

#### 4. virtual_guy

- **生命值**：300 HP（每波 +20）
- **移動速度**：2.0（每波 +0.1）
- **傷害**：25
- **獎勵金錢**：25
- **解鎖波次**：第 4 波
- **生成間隔**：6.0 秒
- **場上上限**：2 隻
- **特殊能力**：分身系統
  - 血量低於 50% 時生成 2 個分身
  - 分身血量為本體的 30%
  - 分身傷害為本體的 50%
  - 分身速度為本體的 120%
  - 分身存活時間 8 秒
  - 分身具有半透明和發光效果

### 敵人行為

- **基本移動**：朝玩家方向移動
- **特殊能力**：
  - **pink_man**：衝刺能力，鎖定玩家位置後高速衝刺
  - **virtual_guy**：分身能力，血量低時生成干擾分身
- **死亡動畫**：消失動畫效果
- **碰撞傷害**：接觸玩家造成傷害

## 🔫 武器配置

### 武器類型

#### 1. pistol

- **傷害**：10
- **攻擊間隔**：400ms
- **射程**：200
- **成本**：100
- **子彈數**：1
- **特色**：就很一般

#### 2. machine Gun

- **傷害**：4
- **攻擊間隔**：150ms
- **射程**：200
- **成本**：100
- **子彈數**：1
- **特色**：高射速

#### 3. shot gun

- **傷害**：2
- **攻擊間隔**：500ms
- **射程**：600
- **成本**：100
- **子彈數**：3
- **特色**：遠射程，多發子彈

### 武器系統

- **自動瞄準**：自動瞄準最近的敵人
- **多武器裝備**：可同時裝備多把武器
- **武器升級**：可升級武器傷害和射速

## 🎯 遊戲邏輯

### 輪次系統

- **波次持續時間**：30 秒每波
- **敵人生成**：根據波次和敵人類型生成
- **波次強化**：每波敵人 HP 和速度會增加
- **場上上限**：最多 25 隻敵人同時存在

### 經驗值系統

- **基礎經驗**：每級需要 100 經驗值
- **經驗增長**：每級經驗需求增加 20%
- **升級獎勵**：升級時恢復 30% 生命值
- **屬性加成**：每級增加移動速度和最大生命值

### 碰撞檢測

- **玩家-敵人**：敵人碰到玩家造成傷害
- **彈丸-敵人**：子彈擊中敵人造成傷害
- **傷害數字**：顯示傷害數值動畫

---

享受遊戲！🎮✨
